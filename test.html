<!DOCTYPE html>
<html lang="en">

<head>
    <title>Minesweeper</title>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <link rel='stylesheet' type='text/css' href='css_folder/minesweeper.css'>
</head>

<body>

    <!-- Audio and SFX-->
    <audio id='ambience' loop>
        <source src='audio/there is no need to be upset.mp3'>
    </audio>
    <audio id='clickSound'>
        <source src='audio/Button-SoundBible.com-1420500901.mp3'>
    </audio>

    <!-- Header -->
    <div id='header'>
        <img src='Images/gear_setting.png' id='gear_pic'>
        <p id='clock'>0:00</p>
        <button id='reset'>Reset</button>
    </div>


    <!-- Board -->
    <div id='board'>
        <h1>MINESWEEPER</h1>
        <p> Click me to play!</p>
    </div>

    <script>
        let easy = document.getElementById('easy');
        let medium = document.getElementById('medium');
        let hard = document.getElementById('hard');
        let restart = document.getElementById('reset');
        let header = document.getElementById('header');
        let board = document.getElementById('board');
        let timer = document.getElementById('clock');
        let gear_pic = document.getElementById('gear_pic');

        let minute = 0;
        let tenth_place_second = 0; //represent seconds in tenth place
        let second = 0; //represent second in ones place

        function clock() {
            second++;
            if (second == 10) {
                // reset_second + add one to tenth_place_second
                tenth_place_second += 1
                second = 0
            }
            if (tenth_place_second == 6) {
                // reset tenth_place_second + add one to minute
                tenth_place_second = 0
                minute += 1
            }
            document.getElementById('clock').innerHTML = minute + ':' + tenth_place_second + '' + second;
        }

        function create_game_board(n) {
            board.innerHTML = ''
            for (let i = 1; i <= n; i++) {
                for (let j = 1; j <= n; j++) {

                    let button = document.createElement("Button");

                    board.appendChild(button);

                    let string = String(i) + String(j);
                    button.id = 'cell' + string;

                    cell_size =  450 / n + 'px'
                    button.style.width = cell_size;
                    button.style.height = cell_size;

                }
                board.innerHTML += "<br/>"

            }
            board.style.border = cell_size * n + 'px solid black'
        }

        function playSound() {
            // play sounds when tap a button
            document.getElementById('clickSound').play();

        }

        function open_setting() {
            // display setting under
            pop_up_href = 'setting.html'
            pop_up_name = 'setting_window'
            center_of_window = window.innerWidth / 2

            window.open(pop_up_href, pop_up_name, 
                        'width=400px, height=400px, left=' +
                        center_of_window)
        }

        function update_setting(event) {
            // when user confirm setting, this apply the changes

            // get info from localStorage
            let mode = event.key
            console.log(mode)
        }

        function first_touch () {
            setInterval(clock, 1000);
            board.onclick = playSound;
            create_game_board(8) //create a medium board by default
            document.getElementById('ambience').play();
        }

        restart.onclick = function reset_board() {
            location.reload();
        }

        // easy.onclick = function mode_easy() {
        //     board.innerHTML = '';
        //     game_board(5);
        // }

        // medium.onclick = function mode_medium() {
        //     board.innerHTML = '';
        //     game_board(8);
        // }

        // hard.onclick = function mode_hard() {
        //     board.innerHTML = '';
        //     game_board(10);
        // }
        
        // click on board the first time
        board.onclick = first_touch

        // click on setting button
        gear_pic.onclick = open_setting
        
        // update the gameplay area if there's a change to setting
        let main_window = window
    </script>
</body>

</html>